# ุฏููู ูุธุงู ุฌูุจ ุงููุธุงุฆู ุงูุชููุงุฆู ๐ค

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ูุธุงู ูุงูู ูุฌูุจ ุงููุธุงุฆู ุชููุงุฆูุงู ูู ุงูููุงูุน ุงูุฎุงุฑุฌูุฉ (ูุซู jobsofoman.com) ุจุฏูู ุงูุญุงุฌุฉ ููุฅุฏุฎุงู ุงููุฏูู.

## ุงูููุฒุงุช โจ

- โ ุฌูุจ ุงููุธุงุฆู ุชููุงุฆูุงู ูู ูููุน Jobs of Oman
- โ ูุญุต ุงููุธุงุฆู ุงูููุฑุฑุฉ ูุชุฌูุจ ุฅุถุงูุชูุง ูุฑุฉ ุฃุฎุฑู
- โ ูุงุฌูุฉ ุณููุฉ ูู ููุญุฉ Admin ููุชุดุบูู ุงููุฏูู
- โ ุฏุนู ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ ุจุงุณุชุฎุฏุงู Cron Jobs
- โ ุชูุงุฑูุฑ ุชูุตูููุฉ ููู ุนูููุฉ ุฌูุจ
- โ ูุงุจู ููุชูุณุน ูุฅุถุงูุฉ ููุงูุน ุฃุฎุฑู

## ุงููููุงุช ุงููุถุงูุฉ ๐

### Backend:
1. **`/supabase/functions/server/job-scraper.tsx`**
   - ูุญุชูู ุนูู logic ุงุณุชุฎุฑุงุฌ ุงููุธุงุฆู ูู HTML
   - ุฏุนู ูููุน jobsofoman.com
   - ูุงุจู ููุชูุณุน ูุฅุถุงูุฉ ููุงูุน ุฃุฎุฑู

2. **Endpoint ุฌุฏูุฏ ูู `/supabase/functions/server/index.tsx`:**
   - `POST /make-server-8a20c00b/admin/scrape-jobs`
   - ูุณุชูุจู `sourceUrl` (ุงุฎุชูุงุฑู)
   - ูููู ุจุฌูุจ ุงููุธุงุฆู ูุญูุธูุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### Frontend:
1. **`/pages/admin/AdminScraperPage.tsx`**
   - ุตูุญุฉ ุฅุฏุงุฑุฉ ูุงููุฉ ูุฌูุจ ุงููุธุงุฆู
   - ุฒุฑ ูุชุดุบูู ุงูุนูููุฉ ูุฏููุงู
   - ุนุฑุถ ูุชุงุฆุฌ ุขุฎุฑ ุนูููุฉ ุฌูุจ
   - ุฅุฑุดุงุฏุงุช ููุตูุฉ ููุฌุฏููุฉ ุงูุชููุงุฆูุฉ

2. **ุชุญุฏูุซ ูู `/utils/adminApi.ts`:**
   - ุฅุถุงูุฉ ุฏุงูุฉ `scrapeJobs()` ููุชูุงุตู ูุน ุงูู endpoint

3. **ุชุญุฏูุซ ูู `/pages/admin/AdminDashboardPage.tsx`:**
   - ุฅุถุงูุฉ ุจุทุงูุฉ "ุฌูุจ ุงููุธุงุฆู ุชููุงุฆูุงู" ูู Quick Actions

## ููููุฉ ุงูุงุณุชุฎุฏุงู ๐

### 1. ุงููุตูู ููุตูุญุฉ

1. ุณุฌู ุฏุฎูู ูู Admin
2. ูู ููุญุฉ ุงูุชุญููุ ุงุถุบุท ุนูู ุจุทุงูุฉ "ุฌูุจ ุงููุธุงุฆู ุชููุงุฆูุงู"
3. ุฃู ุงุฐูุจ ูุจุงุดุฑุฉ ุฅูู: `/admin/scraper`

### 2. ุฌูุจ ุงููุธุงุฆู ูุฏููุงู

1. ุงุถุบุท ุนูู ุฒุฑ "ุฌูุจ ุงููุธุงุฆู ุงูุขู"
2. ุงูุชุธุฑ ุญุชู ุชูุชูู ุงูุนูููุฉ (ูุฏ ุชุณุชุบุฑู 5-30 ุซุงููุฉ)
3. ุณุชุธูุฑ ุงููุชุงุฆุฌ:
   - ุนุฏุฏ ุงููุธุงุฆู ุงููุณุชุฎุฑุฌุฉ ูู ุงููููุน
   - ุนุฏุฏ ุงููุธุงุฆู ุงูุฌุฏูุฏุฉ ุงููุถุงูุฉ
   - ุนุฏุฏ ุงููุธุงุฆู ุงูููุฑุฑุฉ ุงููุชุฌุงููุฉ
   - ูุงุฆูุฉ ุงููุธุงุฆู ุงููุถุงูุฉ

### 3. ุงูุฌุฏููุฉ ุงูุชููุงุฆูุฉ

#### ุงูุทุฑููุฉ 1: Cron-Job.org (ุงูุฃุณูู) โญ

1. **ุงูุชุณุฌูู:**
   - ุงุฐูุจ ุฅูู https://cron-job.org
   - ุฃูุดุฆ ุญุณุงุจ ูุฌุงูู

2. **ุฅูุดุงุก Cron Job:**
   - ุงุถุบุท ุนูู "Create Cronjob"
   - Title: "Scrape Jobs of Oman"

3. **ุฅุนุฏุงุฏ URL:**
   ```
   URL: https://YOUR_PROJECT_ID.supabase.co/functions/v1/make-server-8a20c00b/admin/scrape-jobs
   Method: POST
   ```

4. **Headers:**
   ```
   Content-Type: application/json
   Authorization: Bearer YOUR_SUPABASE_ANON_KEY
   X-Admin-Token: YOUR_ADMIN_TOKEN
   ```

5. **Body (ุงุฎุชูุงุฑู):**
   ```json
   {
     "sourceUrl": "https://jobsofoman.com/ar/index.php"
   }
   ```

6. **Schedule:**
   - ุงุฎุชุฑ "Every 6 hours" ุฃู "Once a day"
   - ููุช ูุญุฏุฏ (ูุซูุงู: 8:00 AM)

7. **Save & Enable**

#### ุงูุทุฑููุฉ 2: GitHub Actions (ูุชูุฏู) ๐

1. **ุฅูุดุงุก Repository:**
   - ุฃูุดุฆ ูุณุชูุฏุน GitHub ุฌุฏูุฏ ุฃู ุงุณุชุฎุฏู ููุฌูุฏ

2. **ุฅูุดุงุก Workflow:**
   - ุฃูุดุฆ ูุฌูุฏ: `.github/workflows/`
   - ุฃูุดุฆ ููู: `scrape-jobs.yml`

3. **ูุญุชูู ุงูููู:**
   ```yaml
   name: Scrape Jobs from Jobs of Oman
   
   on:
     schedule:
       # ูุนูู ูู 6 ุณุงุนุงุช (0:00, 6:00, 12:00, 18:00 UTC)
       - cron: '0 */6 * * *'
     
     # ูููู ุชุดุบููู ูุฏููุงู ูู GitHub UI
     workflow_dispatch:
   
   jobs:
     scrape-jobs:
       runs-on: ubuntu-latest
       
       steps:
         - name: Scrape and Import Jobs
           run: |
             response=$(curl -X POST \
               https://YOUR_PROJECT_ID.supabase.co/functions/v1/make-server-8a20c00b/admin/scrape-jobs \
               -H "Content-Type: application/json" \
               -H "Authorization: Bearer ${{ secrets.SUPABASE_ANON_KEY }}" \
               -H "X-Admin-Token: ${{ secrets.ADMIN_TOKEN }}" \
               -d '{"sourceUrl": "https://jobsofoman.com/ar/index.php"}')
             
             echo "Scrape Result: $response"
             
             # Check if successful
             if echo "$response" | grep -q '"success":true'; then
               echo "โ Jobs scraped successfully!"
             else
               echo "โ Failed to scrape jobs"
               exit 1
             fi
   ```

4. **ุฅุถุงูุฉ Secrets:**
   - ุงุฐูุจ ุฅูู Repository Settings โ Secrets โ Actions
   - ุฃุถู:
     - `SUPABASE_ANON_KEY`: ููุชุงุญ Supabase ุงูุฎุงุต ุจู
     - `ADMIN_TOKEN`: ุชููู ุงูู Admin

5. **ุงูุชุดุบูู:**
   - ุณูุนูู ุชููุงุฆูุงู ุญุณุจ ุงูุฌุฏูู
   - ุฃู ููููู ุชุดุบููู ูุฏููุงู ูู: Actions โ Scrape Jobs โ Run workflow

#### ุงูุทุฑููุฉ 3: Supabase Edge Functions Cron (ูุฑูุจุงู)

> ููุงุญุธุฉ: Supabase ุชุฎุทุท ูุฅุถุงูุฉ ุฏุนู Cron Jobs ูุจุงุดุฑุฉ ูู Edge Functions

#### ุงูุทุฑููุฉ 4: Vercel Cron Jobs

ุฅุฐุง ููุช ุชุณุชุฎุฏู Vercel ูุงุณุชุถุงูุฉ Frontendุ ููููู:

1. ุฅูุดุงุก API Route ูู `/api/cron/scrape-jobs.ts`
2. ุงุณุชุฎุฏุงู Vercel Cron Jobs ูุฌุฏููุฉ ุงูุชูููุฐ

## ุงูุชุฎุตูุต ูุงูุชูุณุน ๐ง

### ุฅุถุงูุฉ ูููุน ุฌุฏูุฏ ููุฌูุจ

1. ุงูุชุญ `/supabase/functions/server/job-scraper.tsx`
2. ุฃุถู ุฏุงูุฉ ุฌุฏูุฏุฉ ูุซู:

```typescript
export async function scrapeNewWebsite(): Promise<ScrapedJob[]> {
  const url = 'https://example.com/jobs';
  const jobs: ScrapedJob[] = [];
  
  // Your scraping logic here
  
  return jobs;
}
```

3. ุญุฏูุซ ุฏุงูุฉ `scrapeWebsite()`:

```typescript
export async function scrapeWebsite(url: string): Promise<ScrapedJob[]> {
  if (url.includes('jobsofoman.com')) {
    return scrapeJobsOfOman();
  } else if (url.includes('example.com')) {
    return scrapeNewWebsite();
  }
  
  throw new Error(`Scraping not supported for URL: ${url}`);
}
```

### ุชุนุฏูู ุชูุฑุงุฑ ุงูุฌูุจ

**ูุตุงุฆุญ ููุชูุฑุงุฑ:**
- โ **ูุฑุฉ ููููุงู**: ููุงุณุจ ููุนุธู ุงูููุงูุน
- โ **ูู 6 ุณุงุนุงุช**: ุฅุฐุง ูุงูุช ุงููุธุงุฆู ุชููุดุฑ ุจุดูู ูุชูุฑุฑ
- โ **ูู ุณุงุนุฉ**: ูุฏ ูุณุจุจ ุญูู ุฒุงุฆุฏ ุนูู ุงูุณูุฑูุฑ
- โ **ุฃูู ูู ุณุงุนุฉ**: ุบูุฑ ููุตูุญ ุจู

### ูุญุต ุงูุณุฌูุงุช (Logs)

#### ูู Supabase:
1. ุงุฐูุจ ุฅูู Dashboard โ Functions
2. ุงุฎุชุฑ `make-server-8a20c00b`
3. ุงุถุบุท ุนูู "Logs"
4. ุงุจุญุซ ุนู logs ุงูู scraping

#### ูู GitHub Actions:
1. ุงุฐูุจ ุฅูู Actions tab
2. ุงุฎุชุฑ ุงูู workflow run
3. ุงุถุบุท ุนูู "Scrape and Import Jobs"
4. ุดุงูุฏ ุงูู output

## ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ๐

### ุงููุดููุฉ: "ูู ูุชู ุงูุนุซูุฑ ุนูู ูุธุงุฆู"

**ุงูุญููู:**
1. ุชุญูู ุฃู ุงููููุน ุงููุตุฏุฑ ูุนูู ุจุดูู ุตุญูุญ
2. ูุฏ ูููู ุงููููุน ุบููุฑ ุจููุฉ HTML
3. ุฑุงุฌุน logs ููุชูุงุตูู
4. ูุฏ ุชุญุชุงุฌ ูุชุญุฏูุซ selectors ูู `job-scraper.tsx`

### ุงููุดููุฉ: "ุฌููุน ุงููุธุงุฆู ููุฌูุฏุฉ ุจุงููุนู"

**ุงูุณุจุจ:** ูุฐุง ุทุจูุนู - ุงููุธุงู ูุชุฌูุจ ุงูุชูุฑุงุฑ

**ุงูุญู:** ูุง ุฏุงุนู ูุฃู ุฅุฌุฑุงุก

### ุงููุดููุฉ: Timeout ุฃู ุจุทุก ูู ุงูุงุณุชุฌุงุจุฉ

**ุงูุญููู:**
1. ุฒุฏ ูู timeout ูู ุงูู cron job
2. ุญุฏูุฏ ุนุฏุฏ ุงููุธุงุฆู ุงููุณุชุฎุฑุฌุฉ ูู `job-scraper.tsx`
3. ุชุญูู ูู ุณุฑุนุฉ ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช

### ุงููุดููุฉ: "Unauthorized" error

**ุงูุญููู:**
1. ุชุญูู ูู ุตุญุฉ Admin Token
2. ุชุญูู ูู ุตุญุฉ Supabase Anon Key
3. ุชุฃูุฏ ุฃู ุงูู token ูู ููุชูู

## ุงูุฃูุงู ๐

โ๏ธ **ููุงุญุธุงุช ูููุฉ:**

1. **ูุง ุชุดุงุฑู Admin Token** ูู ุฃููุงุฏ ุนุงูุฉ
2. ุงุณุชุฎุฏู **Secrets** ูู GitHub Actions
3. ุงุณุชุฎุฏู **Environment Variables** ูู cron-job.org
4. ุฑุงุฌุน logs ุจุงูุชุธุงู ูุงูุชุดุงู ุฃู ูุดุงุท ุบูุฑ ุทุจูุนู

## ุงูุฅุญุตุงุฆูุงุช ูุงูุชุชุจุน ๐

ููููู ุชุชุจุน ูุฌุงุญ ุนูููุงุช ุงูุฌูุจ ูู ุฎูุงู:

1. **ุตูุญุฉ Scraper:** ุนุฑุถ ูุชุงุฆุฌ ุขุฎุฑ ุนูููุฉ
2. **ููุญุฉ ุงููุธุงุฆู:** ุนุฑุถ ุฌููุน ุงููุธุงุฆู ูุน ุงูุชูุงุฑูุฎ
3. **Logs:** ุณุฌูุงุช ููุตูุฉ ููู ุนูููุฉ
4. **Notifications:** ูููู ุฅุถุงูุฉ ุชูุจููุงุช ุนุจุฑ ุงูุจุฑูุฏ (ุชูุณุน ูุณุชูุจูู)

## ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ ๐ฏ

- [ ] ุฅุถุงูุฉ ุฏุนู ูููุงูุน ูุธุงุฆู ุฃุฎุฑู
- [ ] ุชุตููุฉ ุฐููุฉ ูููุธุงุฆู ุญุณุจ ุงููุฆุฉ
- [ ] ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ ุนูุฏ ุฅุถุงูุฉ ูุธุงุฆู ุฌุฏูุฏุฉ
- [ ] ูุงุฌูุฉ ูุฅุฏุงุฑุฉ ูุตุงุฏุฑ ูุชุนุฏุฏุฉ
- [ ] AI ูุชุญุณูู ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช
- [ ] ุชุญููู ุฌูุฏุฉ ุงููุธุงุฆู ุงููุณุชุฎุฑุฌุฉ

## ุงูุฏุนู ูุงููุณุงุนุฏุฉ ๐ฌ

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุฑุงุฌุน ูุฐุง ุงูุฏููู
2. ุชุญูู ูู Logs
3. ุชุฃูุฏ ูู ุชุญุฏูุซ ุฌููุน ุงููููุงุช
4. ุฑุงุฌุน documentations ูู ุงูุฃุนูู

---

## ุงูุฎูุงุตุฉ

ุงููุธุงู ุงูุขู ุฌุงูุฒ ูุฌูุจ ุงููุธุงุฆู ุชููุงุฆูุงู! ๐

**ุงูุฎุทูุงุช ุงูุชุงููุฉ:**
1. โ ุฌุฑุจ ุงูุฌูุจ ุงููุฏูู ูู ุตูุญุฉ `/admin/scraper`
2. โ ุงุฎุชุฑ ุทุฑููุฉ ุฌุฏููุฉ (Cron-Job.org ุฃู GitHub Actions)
3. โ ุงุถุจุท ุงูุชูุฑุงุฑ ุงูููุงุณุจ (ููููุงู ุฃู ูู 6 ุณุงุนุงุช)
4. โ ุฑุงูุจ ุงููุชุงุฆุฌ ูุงูู logs

**ูุฌุงุญ ุงูุนูููุฉ! ๐**
