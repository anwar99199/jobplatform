# โ Amwal Pay - ุฏููู ุงูุชูุนูู ุงูููุงุฆู

## ๐ฏ ุงูุญุงูุฉ ุงูุญุงููุฉ

### โ ูุง ุชู ุฅูุฌุงุฒู (ูู ุทุฑูู):

1. โ **SmartBox.js Script** - ูุชุญูู ุชููุงุฆูุงู ูู `/App.tsx`
2. โ **Backend Endpoint** - `/payment/prepare-smartbox` ูุฅุนุฏุงุฏ configuration
3. โ **SecureHash Calculation** - ูุชู ุญุณุงุจู ุจุดูู ุขูู ูู Backend
4. โ **Frontend Integration** - ูุธุงู SmartBox ูุชูุงูู ูู `/utils/amwal-smartbox.ts`
5. โ **Premium Page** - ุชู ุชุญุฏูุซูุง ูุงุณุชุฎุฏุงู SmartBox Popup
6. โ **Payment Callbacks** - ูุนุงูุฌุฉ ุงููุฌุงุญุ ุงููุดูุ ูุงูุฅูุบุงุก
7. โ **Verification System** - ุงูุชุญูู ุงูุชููุงุฆู ูู ุงูุฏูุน ูุชูุนูู ุงูุงุดุชุฑุงู
8. โ **Sandbox Mode** - ูุนูู ุจุฏูู ุจูุงูุงุช ุญููููุฉ ููุชุฌุฑุจุฉ
9. โ **Database Integration** - ุญูุธ ุงููุนุงููุงุช ูู `payment_sessions`
10. โ **Subscription Activation** - ุชูุนูู ุชููุงุฆู ูู `premium_subscriptions`

---

## ๐ ูุง ูุฌุจ ุนููู ูุนูู ุงูุขู

### ุงููุฑุญูุฉ 1๏ธโฃ: ุงูุชุณุฌูู ูู Amwal Pay

#### ุงูุฎุทูุงุช:
1. ุงุฐูุจ ุฅูู: **https://amwal.tech**
2. ุงุถุบุท ุนูู **"Get Started"** ุฃู **"Sign Up"**
3. ุงููุฃ ูุนูููุงุช ุงูุดุฑูุฉ/ุงููุดุฑูุน:
   - ุงุณู ุงูุดุฑูุฉ: **ููุตุฉ ุนููุงู ูููุธุงุฆู**
   - ููุน ุงููุดุงุท: **ุฎุฏูุงุช ุชูุธูู / Job Portal**
   - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
   - ุฑูู ุงููุงุชู
   - ุงูุณุฌู ุงูุชุฌุงุฑู (ุฅุฐุง ูุงู ูุชููุฑุงู)
4. ุฃููู ุงูุชุญูู ูู ุงููููุฉ (KYC):
   - ุฑูุน ุงููุณุชูุฏุงุช ุงููุทููุจุฉ
   - ุชุฃููุฏ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
   - ุชุฃููุฏ ุงููุงุชู
5. ุงูุชุธุฑ ุงูููุงููุฉ (ูุฏ ุชุณุชุบุฑู 1-3 ุฃูุงู ุนูู)

---

### ุงููุฑุญูุฉ 2๏ธโฃ: ุงูุญุตูู ุนูู ุจูุงูุงุช API

ุจุนุฏ ุงูููุงููุฉ ุนูู ุญุณุงุจู:

#### ููุจูุฆุฉ ุงูุชุฌุฑูุจูุฉ (UAT/Sandbox):
1. ุงุฐูุจ ุฅูู **Dashboard** ูู ุญุณุงุจ Amwal Pay
2. ุงุจุญุซ ุนู ูุณู **"API Credentials"** ุฃู **"Settings"**
3. ุงูุณุฎ ุงูุจูุงูุงุช ุงูุชุงููุฉ:

   ```
   โ MERCHANT_ID (MID) - ููุงุฎุชุจุงุฑ
   โ TERMINAL_ID (TID) - ููุงุฎุชุจุงุฑ
   โ SECURE_HASH - ุงูููุชุงุญ ุงูุณุฑู ููุงุฎุชุจุงุฑ
   ```

#### ููุจูุฆุฉ ุงูุฅูุชุงุฌูุฉ (Production):
ุจุนุฏ ุงูุชูุงู ุงูุงุฎุชุจุงุฑุ ุณุชุญุตู ุนูู:
   ```
   โ MERCHANT_ID (MID) - ููุฅูุชุงุฌ
   โ TERMINAL_ID (TID) - ููุฅูุชุงุฌ
   โ SECURE_HASH - ุงูููุชุงุญ ุงูุณุฑู ููุฅูุชุงุฌ
   ```

---

### ุงููุฑุญูุฉ 3๏ธโฃ: ุฅุถุงูุฉ ุงูุจูุงูุงุช ูู Supabase

#### ุงูุทุฑููุฉ ุงูุณููุฉ (ุนุจุฑ Dashboard):

1. **ุงูุชุญ Supabase Dashboard:**
   ```
   https://supabase.com/dashboard/project/jvfaelfsmpigdeiypuic/settings/secrets
   ```

2. **ุฃุถู ุงููุชุบูุฑุงุช ุงูุชุงููุฉ ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู:**

   ุงุถุบุท **"Add new secret"** ููู ูุงุญุฏุฉ:

   **1. AMWAL_MERCHANT_ID**
   ```
   Name: AMWAL_MERCHANT_ID
   Value: [ุถุน ูููุฉ MID ุงูุชู ุญุตูุช ุนูููุง ูู Amwal Pay]
   
   ูุซุงู: 12345678
   ```

   **2. AMWAL_TERMINAL_ID**
   ```
   Name: AMWAL_TERMINAL_ID
   Value: [ุถุน ูููุฉ TID ุงูุชู ุญุตูุช ุนูููุง ูู Amwal Pay]
   
   ูุซุงู: 87654321
   ```

   **3. AMWAL_SECURE_HASH**
   ```
   Name: AMWAL_SECURE_HASH
   Value: [ุถุน ุงูููุชุงุญ ุงูุณุฑู ุงูุฐู ุญุตูุช ุนููู ูู Amwal Pay]
   
   ูุซุงู: abc123def456ghi789jkl
   ```

   **4. AMWAL_ENVIRONMENT**
   ```
   Name: AMWAL_ENVIRONMENT
   Value: UAT
   
   ููุงุญุธุฉ: ุงุณุชุฎุฏู "UAT" ููุงุฎุชุจุงุฑุ "PRODUCTION" ููุฅูุชุงุฌ
   ```

   **5. AMWAL_SANDBOX_MODE**
   ```
   Name: AMWAL_SANDBOX_MODE
   Value: false
   
   ููุงุญุธุฉ: false = ุงุณุชุฎุฏุงู ุจูุงูุงุช ุญููููุฉุ true = ูุถุน ุงูุชุฌุฑุจุฉ
   ```

3. **ุงุญูุธ ุงูุชุบููุฑุงุช**

4. **โ๏ธ ููู ุฌุฏุงู: ุฃุนุฏ ูุดุฑ Edge Functions**
   - ุงุฐูุจ ุฅูู: **Edge Functions** โ **server**
   - ุงุถุบุท **"Redeploy"**
   - ุงูุชุธุฑ ุญุชู ุชูุชูู ุงูุนูููุฉ (โ Deployed)

---

### ุงููุฑุญูุฉ 4๏ธโฃ: ุงูุงุฎุชุจุงุฑ ุงูุฃููู

#### ุงูุฎุทูุฉ 1: ุชุฌุฑุจุฉ ุงูุงุชุตุงู
1. ุงูุชุญ ูููุนู: `https://your-domain.com`
2. ุงูุชุญ **Console** ูู ุงููุชุตูุญ (F12)
3. ุงุจุญุซ ุนู ุงูุฑุณุงูุฉ:
   ```
   โ Amwal Pay SmartBox script loaded successfully
   ```

#### ุงูุฎุทูุฉ 2: ุชุฌุฑุจุฉ ุนูููุฉ ุฏูุน
1. ุงุฐูุจ ุฅูู ุตูุญุฉ **Premium**
2. ุณุฌูู ุฏุฎูู (ุฃู ุฃูุดุฆ ุญุณุงุจุงู ุชุฌุฑูุจูุงู)
3. ุงุถุบุท **"ุงุดุชุฑู ุงูุขู"** ูุฃู ุจุงูุฉ
4. ุงูุชุธุฑ ุธููุฑ ูุงูุฐุฉ Amwal Pay (Popup)

#### ุงูุฎุทูุฉ 3: ุฃููู ุงูุฏูุน ุงูุชุฌุฑูุจู
1. ูู ูุงูุฐุฉ Amwal Payุ ุฃุฏุฎู ุจูุงูุงุช ุจุทุงูุฉ ุงุฎุชุจุงุฑ
2. (ุงุญุตู ุนูู ุจูุงูุงุช ุจุทุงูุฉ ุงูุงุฎุชุจุงุฑ ูู ูุซุงุฆู Amwal Pay)
3. ุฃููู ุงูุนูููุฉ

#### ุงูุฎุทูุฉ 4: ุชุญูู ูู ุงููุชูุฌุฉ
- โ **ุฅุฐุง ูุฌุญ:** ุณุชูุญูููู ุฅูู ุตูุญุฉ `/payment/success`
- โ **ุชุญูู ูู ุชูุนูู ุงูุงุดุชุฑุงู** ูู ุตูุญุฉ Profile
- โ **ุชุญูู ูู Logs** ูู Supabase Functions

---

### ุงููุฑุญูุฉ 5๏ธโฃ: ุงูุงูุชูุงู ููุฅูุชุงุฌ (ุนูุฏ ุงูุฌุงูุฒูุฉ)

ุนูุฏูุง ุชููู ุฌุงูุฒุงู ููุจูู ุฏูุนุงุช ุญููููุฉ:

#### 1. ุบููุฑ SmartBox Script ูู ุงูููุฏ:

**ุงูุชุญ ุงูููู:** `/App.tsx`

**ุงุจุญุซ ุนู ุงูุณุทุฑ:**
```typescript
script.src = 'https://test.amwalpg.com:7443/js/SmartBox.js?v=1.1'; // UAT
```

**ุบููุฑู ุฅูู:**
```typescript
script.src = 'https://amwalpg.com/js/SmartBox.js?v=1.1'; // Production
```

#### 2. ุญุฏูุซ Environment Variables:

ูู Supabase Secrets:

```
AMWAL_MERCHANT_ID = [MID ููุฅูุชุงุฌ]
AMWAL_TERMINAL_ID = [TID ููุฅูุชุงุฌ]
AMWAL_SECURE_HASH = [SECURE_HASH ููุฅูุชุงุฌ]
AMWAL_ENVIRONMENT = PRODUCTION
AMWAL_SANDBOX_MODE = false
```

#### 3. ุฃุนุฏ ูุดุฑ:
- โ ุฃุนุฏ ูุดุฑ Edge Functions ูู Supabase
- โ ุฃุนุฏ ูุดุฑ Frontend (ุฅุฐุง ููุช ุชุณุชุฎุฏู Vercelุ ุณูุชู ุชููุงุฆูุงู)

#### 4. ุงุฎุชุจุงุฑ ุงูุฅูุชุงุฌ:
- โ ุฌุฑูุจ ุนูููุฉ ุฏูุน ุญููููุฉ ุจูุจูุบ ุตุบูุฑ (ูุซูุงู 0.5 ุฑูุงู)
- โ ุชุญูู ูู ูุตูู ุงููุจูุบ ุฅูู ุญุณุงุจ Amwal Pay
- โ ุชุญูู ูู ุชูุนูู ุงูุงุดุชุฑุงู

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ

### ุฎุทุฃ: "ูุธุงู ุงูุฏูุน ุบูุฑ ูุญููู"

**ุงูุณุจุจ:** SmartBox.js ูู ูุชู ุชุญูููู

**ุงูุญู:**
1. ุงูุชุญ Console ูู ุงููุชุตูุญ
2. ุงุจุญุซ ุนู ุฃุฎุทุงุก ูู ุชุญููู ุงูุณูุฑูุจุช
3. ุชุฃูุฏ ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช
4. ุฃุนุฏ ุชุญููู ุงูุตูุญุฉ

---

### ุฎุทุฃ: "ูุธุงู ุงูุฏูุน ุบูุฑ ููุชูู ุงูุฅุนุฏุงุฏ"

**ุงูุณุจุจ:** ุจูุงูุงุช Amwal Pay ููููุฏุฉ ุฃู ุบูุฑ ุตุญูุญุฉ

**ุงูุญู:**
1. ุชุญูู ูู ุฅุถุงูุฉ ุฌููุน ุงููุชุบูุฑุงุช ูู Supabase:
   - AMWAL_MERCHANT_ID
   - AMWAL_TERMINAL_ID
   - AMWAL_SECURE_HASH
2. ุชุฃูุฏ ูู **ุฅุนุงุฏุฉ ูุดุฑ Edge Functions** ุจุนุฏ ุฅุถุงูุฉ ุงููุชุบูุฑุงุช
3. ุงูุชุญ Logs ูู Supabase Functions ูุงุจุญุซ ุนู:
   ```
   ๐ณ SmartBox Configuration: { hasCredentials: true }
   ```

---

### ุฎุทุฃ: "Invalid SecureHash"

**ุงูุณุจุจ:** ุตูุบุฉ ุญุณุงุจ Hash ุบูุฑ ูุชุทุงุจูุฉ ูุน Amwal Pay

**ุงูุญู:**
1. **ุชูุงุตู ูุน ุฏุนู Amwal Pay:** support@amwal.tech
2. ุงุณุฃููู ุนู ุงูุตูุบุฉ ุงูุฏูููุฉ ูุญุณุงุจ SecureHash
3. ุฑุงุฌุน ุงูููู: `/AMWAL_SECUREHASH_FORMAT.md`
4. ุนุฏูู ุงูุตูุบุฉ ูู `/supabase/functions/server/index.tsx` (ุงูุณุทุฑ 2109)

---

### ุฎุทุฃ: ูุงูุฐุฉ ุงูุฏูุน ูุง ุชุธูุฑ

**ุงูุณุจุจ:** ุฎุทุฃ ูู ุชูููู SmartBox

**ุงูุญู:**
1. ุงูุชุญ Console ูู ุงููุชุตูุญ
2. ุงุจุญุซ ุนู ุฑุณุงุฆู ุฎุทุฃ
3. ุชุญูู ูู:
   ```javascript
   console.log("โ SmartBox configured successfully")
   ```
4. ุชุฃูุฏ ูู ุฃู `PaymentViewType = 1` (Popup)

---

### ุงูุฏูุน ูุฌุญ ููู ุงูุงุดุชุฑุงู ูู ูููุนูู

**ุงูุณุจุจ:** ุฎุทุฃ ูู ุงูุชุญูู ูู ุงูุฏูุน

**ุงูุญู:**
1. ุงูุชุญ Logs ูู Supabase Functions
2. ุงุจุญุซ ุนู ุฑุณุงุฆู ุงูุชุญูู:
   ```
   โ Payment verified successfully
   ```
3. ุชุญูู ูู ุฌุฏูู `premium_subscriptions` ูู Supabase
4. ุชุญูู ูู ุฌุฏูู `payment_sessions`

---

## ๐ ููููุฉ ูุฑุงูุจุฉ ุงูุฏูุนุงุช

### ูู Supabase:

1. **ุฌุฏูู payment_sessions:**
   - ูุญุชูู ุนูู ุฌููุน ุงููุนุงููุงุช
   - `status`: pending, completed, failed

2. **ุฌุฏูู premium_subscriptions:**
   - ูุญุชูู ุนูู ุงูุงุดุชุฑุงูุงุช ุงููุดุทุฉ
   - `status`: active, expired

3. **Edge Functions Logs:**
   - ุงุฐูุจ ุฅูู: Functions โ server โ Logs
   - ุฑุงูุจ ุฑุณุงุฆู ุงููุฌุงุญ ูุงููุดู

### ูู Amwal Pay Dashboard:

1. ุณุฌูู ุฏุฎูู ุฅูู ุญุณุงุจ Amwal Pay
2. ุงุฐูุจ ุฅูู **Transactions** ุฃู **Payments**
3. ุฑุงูุจ ุฌููุน ุงููุนุงููุงุช
4. ุชุญูู ูู ุญุงูุฉ ูู ูุนุงููุฉ

---

## โ๏ธ ูุตุงุฆุญ ุฃูููุฉ ูููุฉ

### โ ุงูุนู:
- โ ุงุญูุธ SECURE_HASH ูู ููุงู ุขูู
- โ ุงุณุชุฎุฏู Environment Variables ููุท
- โ ุฑุงูุจ ุงููุนุงููุงุช ุจุงูุชุธุงู
- โ ูุนูู ุฅุดุนุงุฑุงุช ุงูุจุฑูุฏ ูู Amwal Pay
- โ ุงุฎุชุจุฑ ุฌูุฏุงู ูู UAT ูุจู ุงูุฅูุชุงุฌ

### โ ูุง ุชูุนู:
- โ ูุง ุชุดุงุฑู SECURE_HASH ูุน ุฃุญุฏ
- โ ูุง ุชุถุน ุงูููุงุชูุญ ูู ุงูููุฏ ูุจุงุดุฑุฉ
- โ ูุง ุชูุณู ุฅุนุงุฏุฉ ูุดุฑ Edge Functions ุจุนุฏ ุงูุชุนุฏููุงุช
- โ ูุง ุชูุชูู ููุฅูุชุงุฌ ูุจู ุงุฎุชุจุงุฑ ุดุงูู ูู UAT
- โ ูุง ุชุชุฑู debug logs ูู Production

---

## ๐ Checklist ุงูููุงุฆู

### ูุจู ุงูุจุฏุก:
- [ ] ูุฑุฃุช ุฌููุน ุงููููุงุช ุงูุชูุซูููุฉ
- [ ] ูููุช ููููุฉ ุนูู ุงููุธุงู
- [ ] ุฌูุฒุช ุงููุณุชูุฏุงุช ุงููุทููุจุฉ ููุชุณุฌูู ูู Amwal Pay

### ูุฑุญูุฉ ุงูุชุณุฌูู:
- [ ] ุณุฌูุช ูู Amwal Pay
- [ ] ุฃูููุช KYC verification
- [ ] ุญุตูุช ุนูู ุงูููุงููุฉ

### ูุฑุญูุฉ ุงูุฅุนุฏุงุฏ:
- [ ] ุญุตูุช ุนูู MID, TID, SECURE_HASH ููุงุฎุชุจุงุฑ
- [ ] ุฃุถูุช ุฌููุน ุงููุชุบูุฑุงุช ูู Supabase Secrets
- [ ] ุฃุนุฏุช ูุดุฑ Edge Functions
- [ ] ุชุญููุช ูู ุชุญููู SmartBox.js (ูู Console)

### ูุฑุญูุฉ ุงูุงุฎุชุจุงุฑ:
- [ ] ุฌุฑุจุช ุนูููุฉ ุฏูุน ุชุฌุฑูุจูุฉ ูุงููุฉ
- [ ] ุชุญููุช ูู ุธููุฑ ูุงูุฐุฉ Amwal Pay
- [ ] ุฃูููุช ุงูุฏูุน ุจูุฌุงุญ
- [ ] ุชุญูู ูู ุชูุนูู ุงูุงุดุชุฑุงู ุชููุงุฆูุงู
- [ ] ุฑุงุฌุนุช Logs ูู Supabase

### ูุฑุญูุฉ ุงูุฅูุชุงุฌ (ุนูุฏ ุงูุฌุงูุฒูุฉ):
- [ ] ุญุตูุช ุนูู MID, TID, SECURE_HASH ููุฅูุชุงุฌ
- [ ] ุบููุฑุช SmartBox Script ุฅูู Production URL
- [ ] ุญุฏูุซุช Environment Variables ููุฅูุชุงุฌ
- [ ] ุฃุนุฏุช ูุดุฑ Edge Functions ู Frontend
- [ ] ุฌุฑุจุช ุนูููุฉ ุฏูุน ุญููููุฉ ุตุบูุฑุฉ
- [ ] ุชุญููุช ูู ูุตูู ุงููุจูุบ ุฅูู ุญุณุงุจ Amwal Pay
- [ ] ุชุญููุช ูู ุชูุนูู ุงูุงุดุชุฑุงู ูู Production

---

## ๐ ุงูุฏุนู ูุงููุณุงุนุฏุฉ

### ูุซุงุฆู Amwal Pay:
- **ุงููููุน:** https://amwal.tech
- **ุงููุซุงุฆู:** https://docs.amwal.tech (ุฅุฐุง ูุงูุช ูุชููุฑุฉ)

### ุฏุนู Amwal Pay:
- **ุงูุจุฑูุฏ:** support@amwal.tech
- **ุงููุงุชู:** (ุชุญูู ูู ูููุน Amwal Pay)

### Supabase:
- **Dashboard:** https://supabase.com/dashboard
- **Logs:** Functions โ server โ Logs
- **ุงููุซุงุฆู:** https://supabase.com/docs

---

## ๐ ุงูููุงูุฉ

**ุงููุธุงู ุฌุงูุฒ ุจุงููุงูู!**

ูู ูุง ุชุญุชุงุฌู ูู:
1. โ ุงูุชุณุฌูู ูู Amwal Pay
2. โ ุงูุญุตูู ุนูู ุงูุจูุงูุงุช
3. โ ุฅุถุงูุชูุง ูู Supabase
4. โ ุงูุงุฎุชุจุงุฑ!

**ุจุนุฏ ุฐููุ ุณุชููู ููุตุฉ ุนููุงู ูููุธุงุฆู ุฌุงูุฒุฉ ููุจูู ุงููุฏููุนุงุช!** ๐

---

**ุชุงุฑูุฎ ุงูุฅุนุฏุงุฏ:** 27 ููููุจุฑ 2024  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ 100%  
**ุงููุถุน ุงูุญุงูู:** ๐ญ Sandbox Mode (ููุชุฌุฑุจุฉ - ูุง ูุญุชุงุฌ ุจูุงูุงุช ุญููููุฉ)  
**ุงููุทููุจ ููู:** ๐ ููุท ุฅุถุงูุฉ ุจูุงูุงุช Amwal Pay ููุชูุนูู ุงููุงูู
